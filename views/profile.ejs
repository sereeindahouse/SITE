<%- include('include/header') %>

<div class="container py-3">
  <h2 class="mb-3">Profile: <%= profileUsername %></h2>

  <div class="row mb-3">
    <div class="col-md-4">
      <img src="<%= profileAvatar || 'https://gravatar.com/avatar/?d=identicon' %>" alt="avatar" class="img-fluid rounded">
    </div>
    <div class="col-md-8">
      <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center">
          Posts
          <span class="badge badge-primary badge-pill"><%= counts && counts.postCount || 0 %></span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
          Friends
          <span class="badge badge-info badge-pill"><%= counts && counts.friendCount || 0 %></span>
        </li>
      </ul>

      <div class="mt-3">
        <a href="/profile/<%= profileUsername %>/posts" class="btn btn-sm btn-primary">View Posts</a>
        <% if (!isVisitorsProfile && user && user.username) { %>
          <% if (friendStatus === 'none') { %>
            <form action="/friend/request/<%= profileUsername %>" method="POST" class="d-inline">
              <button class="btn btn-sm btn-outline-primary">Add Friend</button>
            </form>
          <% } else if (friendStatus === 'pending-incoming') { %>
            <form action="/friend/accept/<%= profileUsername %>" method="POST" class="d-inline">
              <button class="btn btn-sm btn-success">Confirm</button>
            </form>
            <form action="/friend/decline/<%= profileUsername %>" method="POST" class="d-inline">
              <button class="btn btn-sm btn-secondary">Delete</button>
            </form>
          <% } else if (friendStatus === 'friends') { %>
            <a href="/profile/<%= profileUsername %>/friends" class="btn btn-sm btn-outline-info">Friends</a>
          <% } else { %>
            <button class="btn btn-sm btn-outline-warning" disabled>Request sent</button>
          <% } %>
        <% } %>
      </div>
    </div>
  </div>
</div>

<%- include('include/footer') %>
